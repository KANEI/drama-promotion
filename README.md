# ベイズ統計モデリングによる公演動員数予測

## 概要
 - このプロジェクトは、過去の公演データを用いて、将来の公演における動員数をベイズ統計モデリング（ロジスティック回帰）を用いて予測するものです。
 - PythonのライブラリであるPyMCを使用し、マルコフ連鎖モンテカルロ法（MCMC）によってパラメータの事後分布を推定します。最終的に、特定の条件下（公演数、有料/無料など）での集客率と具体的な動員数を予測し、その結果をテキストファイルに出力します。

## 機能
 - データ前処理: CSVファイルから過去の公演データを読み込み、企画ごとに集計・整形します。
 - ベイズモデル構築: PyMCを用いて、公演数と有料公演かどうかが集客率に与える影響をモデル化します。
 - MCMCサンプリング: MCMCを実行し、モデルのパラメータ（β_0,β_1 ,β_2）の事後分布を推定します。
 - 動員数予測: 新しい公演の条件（公演数、有料/無料）に基づき、集客率の事後分布を計算し、具体的な動員数を予測します。

## 結果の可視化と保存:
 - 入力データのヒストグラムを画像ファイルとして保存します。
 - モデルの要約と最終的な予測結果をテキストファイルとして保存します。

## ファイル構成
├── data/
│   └── 過去の本企画集客.csv  # 入力データ
├── src/
│   └── baysian_model.py   # メインの実行スクリプト
├── .venv                  # 仮想環境
├── requreiments.txt       # 必要なライブラリ一覧
├── .gitignore
├── images/                   <-- このフォルダを追加
│   └── model_explanation.png
└── outputs/
    ├── histogram.png       # 生成されるヒストグラム画像
    └── pymc_summary.txt    # 生成される予測結果のサマリー


## 必要条件
このスクリプトを実行するのに必要なライブラリはrequirements.txtにあります。

## モデルの説明
このプロジェクトで使用しているベイズモデルの構造は、以下の図の通りです。

![モデル構造のダイアグラム](./images/model_explanation.png)

事後分布ついて、サンプルを生成し、それを元に新しいp_iを予測する。

## 出力例
実行後、outputs/pymc_summary.txtに以下のような形式で結果が出力されます。

-------- 過去の公演の基本的な情報 --------
                 キャパ         予約数        公演数       有料公演
count   18.000000   18.000000  18.000000  18.000000
mean   349.555556  274.722222   9.000000   0.500000
...
-------- 過去のデータに基づいた予測 --------
Y=4, Z=1 の場合の p の事後平均: 0.7523
Y=4, Z=1 の場合の p の94% HDI区間: [0.686 0.812]
----------------------------------------
キャパ38で、4ステ料金制の公演とする。
1ステあたりの予測動員数: 28.587...
予測総動員数: 114.351...
1ステあたりの動員数の94%予測区間: [26.069 30.849]
総動員数の94%予測区間: [104.279 123.398]